
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sistema Documental Insular</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f4f4f4; }
    header { display: flex; align-items: center; gap: 10px; }
    img { height: 50px; }
    h2 { color: #003366; }
    table { border-collapse: collapse; width: 100%; background: white; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #003366; color: white; }
    select, input[type="file"], input[type="text"], button { margin: 10px 5px; padding: 8px; }
    .status { margin-top: 10px; color: green; font-weight: bold; }
  </style>
</head>
<body>
  <header>
    <img src="logo_gobierno_insular_web.png" alt="Logo" />
    <h2>Sistema Documental Insular</h2>
  </header>

  <form id="uploadForm">
    <label for="tipo">Tipo de documento:</label>
    <select id="tipo" required>
      <option value="">Selecciona una categoría</option>
      <option value="📄 Plano">📄 Plano</option>
      <option value="📑 Memorando">📑 Memorando</option>
      <option value="📝 Acta">📝 Acta</option>
      <option value="📘 Normativa">📘 Normativa</option>
      <option value="📂 Otro">📂 Otro</option>
      <option value="📊 Excel">📊 Excel</option>
    </select>
    <input type="file" id="fileInput" required />
    <button type="submit">Subir y enviar</button>
    <p id="status" class="status"></p>
  </form>

  <input type="text" id="search" placeholder="Buscar por nombre..." />
  <select id="filterTipo">
    <option value="">Filtrar por tipo</option>
    <option value="📄 Plano">📄 Plano</option>
    <option value="📑 Memorando">📑 Memorando</option>
    <option value="📝 Acta">📝 Acta</option>
    <option value="📘 Normativa">📘 Normativa</option>
    <option value="📂 Otro">📂 Otro</option>
    <option value="📊 Excel">📊 Excel</option>
  </select>

  <table id="documentTable">
    <thead>
      <tr><th>Tipo</th><th>Nombre</th><th>Fecha</th><th>Descargar</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const tabla = document.querySelector("#documentTable tbody");
    const status = document.getElementById("status");

    let historial = JSON.parse(localStorage.getItem("documentos")) || [];

    function renderTabla() {
      tabla.innerHTML = "";
      const search = document.getElementById("search").value.toLowerCase();
      const filterTipo = document.getElementById("filterTipo").value;

      historial
        .filter(doc => (!filterTipo || doc.tipo === filterTipo))
        .filter(doc => doc.nombre.toLowerCase().includes(search))
        .forEach(doc => {
          const fila = `<tr>
            <td>${doc.tipo}</td>
            <td>${doc.nombre}</td>
            <td>${doc.fecha}</td>
            <td><a href="${doc.url}" download>📥</a></td>
          </tr>`;
          tabla.innerHTML += fila;
        });
    }

    document.getElementById("uploadForm").addEventListener("submit", async e => {
      e.preventDefault();
      const tipo = document.getElementById("tipo").value;
      const fileInput = document.getElementById("fileInput");
      const file = fileInput.files[0];
      if (!tipo || !file) return;

      const fecha = new Date().toLocaleDateString("es-VE");
      const fakeURL = URL.createObjectURL(file);
      historial.push({ tipo, nombre: file.name, fecha, url: fakeURL });
      localStorage.setItem("documentos", JSON.stringify(historial));
      renderTabla();

      status.textContent = "✅ Documento simulado como enviado a Telegram.";
    });

    document.getElementById("search").addEventListener("input", renderTabla);
    document.getElementById("filterTipo").addEventListener("change", renderTabla);

    renderTabla();
  </script>
</body>
</html>
